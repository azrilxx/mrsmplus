# MARA+ Agent Integration Hooks

This directory contains the intelligent agent integration system for MARA+, providing AI-driven insights and personalized content across all dashboard roles.

## Overview

The agent integration hooks replace static mock data with dynamic, intelligent content generated by specialized Claude sub-agents. Each agent is designed for specific responsibilities and provides contextual insights based on user behavior patterns and system analytics.

## Architecture

```
hooks/
├── types/
│   └── agent-interfaces.ts     # TypeScript interfaces for all agents
├── utils/
│   └── agent-client.ts         # Base agent client and communication utilities
├── useLeaderboardEngine.ts     # Dynamic leaderboard with competitive insights
├── useFeedbackSynthesizer.ts   # Student diagnostics and intervention recommendations
├── useParentModule.ts          # Parent engagement tips and motivation cards
├── useStudyReflection.ts       # Personalized study insights and confidence tracking
├── useWatchtowerSentinel.ts    # System monitoring and performance alerts
├── useXPSyncAgent.ts           # XP synchronization across all views
├── useAgentOrchestrator.ts     # Main orchestration and coordination
└── index.ts                    # Centralized exports
```

## Specialized Agents

### 1. Leaderboard Engine (`useLeaderboardEngine`)

**Purpose**: Generate dynamic leaderboards with real-time rankings, streak tracking, and competitive insights.

**Features**:
- Real-time competitive rankings
- Motivational messages based on performance
- Achievement opportunities identification
- Subject-specific standings
- Streak comparison and growth tracking

**Usage**:
```typescript
import { useStudentLeaderboard, useTeacherLeaderboard } from './hooks';

// For student dashboard
const { leaderboard, competitiveMetrics, motivationalMessages } = useStudentLeaderboard(context);

// For teacher dashboard  
const { leaderboard, refreshLeaderboard } = useTeacherLeaderboard(context);
```

### 2. Feedback Synthesizer (`useFeedbackSynthesizer`)

**Purpose**: Analyze student performance patterns and generate diagnostic insights for teachers.

**Features**:
- Risk level assessment and early intervention
- Performance trend analysis
- Engagement diagnostic metrics
- Personalized intervention recommendations
- Behavioral pattern recognition

**Usage**:
```typescript
import { useTeacherDiagnostics, useAdminDiagnostics } from './hooks';

// For teacher dashboard
const { diagnostics, riskAnalysis, interventionRecommendations } = useTeacherDiagnostics(context);

// For admin dashboard
const { performanceTrends, generateInterventionPlan } = useAdminDiagnostics(context);
```

### 3. Parent Module (`useParentModule`)

**Purpose**: Create engagement tips and motivation cards for parents based on child activity.

**Features**:
- Personalized motivation cards
- Engagement tips categorized by type
- Achievement highlights and concern identification
- Recommended parent actions with timing
- Multi-child family management

**Usage**:
```typescript
import { useParentModule, useMultiChildParentModule } from './hooks';

// Single child focus
const { motivationCards, engagementTips, recommendedActions } = useParentModule(context, childrenData);

// Multiple children
const { achievementHighlights, concernAreas } = useMultiChildParentModule(context, childrenData);
```

### 4. Study Reflection (`useStudyReflection`)

**Purpose**: Generate personalized study insights and confidence tracking for students.

**Features**:
- Mood-based reflection generation
- Personalized feedback and growth areas
- Confidence level tracking over time
- Celebration points and next steps
- Post-session analysis

**Usage**:
```typescript
import { useStudyReflection, usePostSessionReflection } from './hooks';

// General reflection
const { reflection, personalizedFeedback, nextSteps } = useStudyReflection(context);

// Post-session specific
const { updateMoodReflection, getConfidenceInsights } = usePostSessionReflection(context, sessionData);
```

### 5. Watchtower Sentinel (`useWatchtowerSentinel`)

**Purpose**: Provide system health monitoring and performance alerts for admins.

**Features**:
- Real-time system health monitoring
- Performance analysis and trend identification
- Predictive alerts for potential issues
- Component health tracking
- Optimization recommendations

**Usage**:
```typescript
import { useAdminWatchtower, useRealTimeMonitoring } from './hooks';

// Admin monitoring
const { alerts, systemHealth, performanceAnalysis } = useAdminWatchtower(context);

// Real-time monitoring
const { predictiveAlerts, generatePerformanceReport } = useRealTimeMonitoring(context);
```

### 6. XP Sync Agent (`useXPSyncAgent`)

**Purpose**: Ensure XP data consistency across all role views and provide synchronized progress tracking.

**Features**:
- Real-time XP synchronization
- Discrepancy detection and resolution
- Cross-view data consistency
- Sync status monitoring
- Performance optimization

**Usage**:
```typescript
import { useStudentXPSync, useTeacherXPSync, useAdminXPSync } from './hooks';

// Student view (immediate feedback)
const { xpProgress, syncStatus } = useStudentXPSync(context);

// Teacher view (class management)
const { validateSync, resolveDiscrepancy } = useTeacherXPSync(context);

// Admin view (system-wide sync)
const { discrepancies, forceSyncAll } = useAdminXPSync(context);
```

## Agent Orchestrator

The main orchestrator (`useAgentOrchestrator`) coordinates all agents and provides unified dashboard data.

**Features**:
- Role-based agent coordination
- Cross-agent pattern analysis
- Intelligent insights generation
- Agent status monitoring
- Unified data aggregation

**Usage**:
```typescript
import { 
  useStudentDashboardAgents, 
  useTeacherDashboardAgents, 
  useParentDashboardAgents, 
  useAdminDashboardAgents 
} from './hooks';

// Role-specific orchestration
const { 
  dashboardData, 
  agentStatuses, 
  generateIntelligentInsights 
} = useStudentDashboardAgents(userId);
```

## Configuration Options

### Agent Client Configuration

```typescript
interface AgentConfig {
  enabled: boolean;              // Enable/disable agent
  cacheTTL: number;             // Cache time-to-live (milliseconds)
  retryAttempts: number;        // Number of retry attempts
  timeout: number;              // Request timeout (milliseconds)
  fallbackToMock: boolean;      // Use mock data on failure
}
```

### Orchestrator Configuration

```typescript
interface AgentOrchestratorConfig {
  role: 'student' | 'teacher' | 'parent' | 'admin';
  userId?: string;
  enabledAgents?: string[];                    // Which agents to activate
  refreshInterval?: number;                    // Auto-refresh interval
  enableCrossAgentAnalysis?: boolean;          // Enable intelligent insights
  prioritizeRealTimeUpdates?: boolean;         // Prioritize real-time data
}
```

## Data Flow

1. **User Interaction**: User interacts with dashboard components
2. **Behavior Tracking**: User behavior is captured and stored
3. **Agent Invocation**: Relevant agents are triggered based on context
4. **Data Processing**: Agents process behavior data and generate insights
5. **Content Generation**: Intelligent content is generated and cached
6. **Dashboard Update**: UI components receive fresh, personalized data
7. **Cross-Agent Analysis**: Orchestrator identifies patterns across agents

## Performance Optimization

### Caching Strategy
- Intelligent caching with configurable TTL
- Role-based cache invalidation
- Cross-agent cache coordination

### Real-Time Updates
- WebSocket-like behavior simulation
- Prioritized updates for critical data
- Batched updates for performance

### Error Handling
- Graceful degradation to mock data
- Retry mechanisms with exponential backoff
- Agent health monitoring and recovery

## Integration Examples

### Replacing Mock Data in Student Dashboard

**Before** (static mock):
```typescript
const mockData = useMockFirestore();
const data = mockData.getDashboardData('student');
```

**After** (intelligent agents):
```typescript
const { dashboardData, generateIntelligentInsights } = useStudentDashboardAgents(userId);
```

### Adding Real-Time Insights

```typescript
// Get cross-agent insights
const insights = await generateIntelligentInsights();

// Display intelligent recommendations
{insights.actionableRecommendations.map(rec => (
  <InsightCard key={rec} recommendation={rec} />
))}
```

### Customizing Agent Behavior

```typescript
// Custom parent module for growth mindset
const parentHook = useParentModule(context, childrenData, {
  motivationStyle: 'growth-mindset',
  includeProactiveTips: true,
  autoRefresh: true
});
```

## Helper Functions

Each agent hook includes utility functions for formatting and styling:

```typescript
// Leaderboard styling
const styling = getLeaderboardStyling(rank);

// Risk level visualization  
const riskStyle = getRiskLevelStyling(riskLevel);

// Motivation card formatting
const cardStyle = getMotivationCardStyling(cardType);

// System health indicators
const healthStatus = formatHealthScore(score);
```

## Testing and Development

### Mock Agent Responses
The system includes intelligent mock responses that simulate real agent behavior for development and testing.

### Agent Status Monitoring
Use the orchestrator to monitor agent health and performance:

```typescript
const { agentStatuses } = useAgentOrchestrator(config);
const overallHealth = getOverallAgentHealth(agentStatuses);
```

### Development Mode
Set `fallbackToMock: true` in agent configuration for reliable development experience.

## Future Enhancements

- **Machine Learning Integration**: Direct ML model integration for predictions
- **Real-time WebSocket Support**: True real-time agent communication
- **Advanced Caching**: Redis or similar for distributed caching
- **Agent Marketplace**: Plugin system for custom agents
- **Performance Analytics**: Detailed agent performance monitoring

## Contributing

When adding new agents:

1. Create agent interface in `types/agent-interfaces.ts`
2. Implement agent hook following existing patterns
3. Add orchestrator integration
4. Include helper functions for UI formatting
5. Update exports in `index.ts`
6. Add documentation and examples

## Support

For questions about agent integration:
- Check existing agent implementations for patterns
- Review TypeScript interfaces for data structures
- Test with mock responses before implementing real agents
- Monitor agent status through the orchestrator